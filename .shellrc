#!/bin/bash

# vim: set fdm=marker:

# ----------------------------
# Shared shells configuration
# ----------------------------

# Load env variables {{{

if test -r "$HOME/.env"; then
  export $(cat "$HOME/.env" | xargs)
else
  echo "⚠️  No env found!"
fi

# }}}

# ls aliases {{{

alias ll="ls -alFG"
alias ls="ls -G"
alias la="ls -AG"
alias l="ls -CFG"

# }}}

# Folder navigation aliases {{{

alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."

# }}}

# Git utils {{{

alias g="git"

# Alias to handle `config` bare repo more easily
alias config="/usr/bin/git --git-dir=$HOME/.config.git/ --work-tree=$HOME"

# }}}

# App aliases {{{

alias chrome="/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome"
alias v="nvim"
alias lazyconfig="lazygit --git-dir=$HOME/.config.git/ --work-tree=$HOME"
alias emacs="emacsclient --alternate-editor=''"
alias cat="bat"
alias sf="~/dev/superflash/venv/bin/python3 ~/dev/superflash/src/main.py"

# }}}

# Shell functions {{{

# Prints all the processes currently listening on a port
processes_listening_in_port() {
  lsof -i:"$1" -sTCP:LISTEN
}

# Prints the size of an element. Can be used with `folder_name\/*` syntax
foldersize() {
  du -hcs "$1"
}

# https://wiki.vifm.info/index.php/How_to_set_shell_working_directory_after_leaving_Vifm
vicd() {
  local dst
  dst="$(command vifm --choose-dir - "$@")"
  if [ -z "$dst" ]; then
    echo "Directory picking cancelled/failed"
    return 1
  fi
  cd "$dst" || exit
}

# }}}

# Company-specific stuff {{{

if test -r "$HOME/.workrc"; then
  # shellcheck source=/Users/elia.camposilvan/.workrc
  source "$HOME/.workrc"
fi

# }}}
